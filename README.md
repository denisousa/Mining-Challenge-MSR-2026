# An Empirical Study of Code Clone Genealogies in Humanâ€“AI Collaborative Development

A project for analyzing Pull Requests generated by AI agents vs. human PRs in open-source repositories. The project uses code clone analysis (genealogy) to compare change patterns and evolution between agent and human PRs.

## ğŸ“‹ Requirements

- **Python**: 3.12 or 3.13
- **Poetry**: Dependency manager (install via `pip install poetry`)
- **GitHub Token**: Required to access GitHub API (https://github.com/settings/tokens)
- **Git**: To clone repositories

## ğŸš€ Installation

### 1. Clone the Repository

```bash
git clone https://github.com/denisousa/Mini-Challenge-MSR-2026.git
cd Mini-Challenge-MSR-2026
```

### 2. Configure GitHub Token

Create a `.env` file at the project root with your GitHub token:

```bash
echo "GITHUB_TOKEN=your_token_here" > .env
```

**How to get a GitHub token:**
1. Go to https://github.com/settings/tokens
2. Click "Generate new token" â†’ "Generate new token (classic)"
3. Select scopes: `repo`, `read:user`, `user:email`
4. Copy the token and add it to the `.env` file

### 3. Install Dependencies

```bash
poetry install
```

This will install all dependencies listed in `pyproject.toml`:
- **pandas** (>=2.3.3) - Data manipulation
- **requests** (>=2.32.5) - HTTP requests for GitHub API
- **gitpython** (>=3.1.45) - Git repository interaction
- **matplotlib** (>=3.10.7) - Visualizations
- **seaborn** (>=0.13.2) - Statistical plots
- **scipy** (>=1.11.0) - Statistical analysis
- **pyarrow**, **fastparquet** - Data processing
- **huggingface-hub** (>=0.20.0) - Hugging Face integration
- **python-dotenv** (>=1.0.0) - Environment variable loading
- **tabulate** (>=0.9.0) - Table formatting

## ğŸƒ Execution

Run the complete pipeline that executes all 10 analysis scripts in sequence:

```bash
./complete_execution.sh
```

This script will automatically use **Poetry** to run each script in the proper order and provide timing information for each step.

## ğŸ“Š Generated Data and Artifacts

### ğŸ“‚ Artifacts Directory

The **`artifacts/`** directory contains pre-generated data and results. When you run the `complete_execution.sh` script, it will generate the same output in the `main_results` folder.

#### ğŸ“‹ Analysis and Mining CSVs

CSV files generated during the data mining process (scripts 1-5):

- **`all_merged_prs_with_repo_info.csv`**: All merged pull requests with repository information
- **`balanced_repositories.csv`**: Repositories selected for balanced comparison between agent and human PRs
- **`human_agent_prs_with_commits.csv`**: Pull requests with associated commits for both human and agent contributions
- **`human_agent_pull_request.csv`**: Filtered pull requests from both humans and agents
- **`new_agent_pull_request.csv`**: Newly identified agent-generated pull requests
- **`new_human_pull_request.csv`**: Newly identified human-generated pull requests

### ğŸ§¬ Genealogy Results Directory

The **`genealogy_results/`** directory contains the code clone genealogy files generated by script 5:

- **`<language>_<project>.xml`**: Contains the complete **code clone genealogy** of each analyzed project. These XML files track the evolution and relationships of code clones throughout the project's history, showing how clones are born, evolve, and die across different commits.
  - Examples: `py_airbytehq_airbyte.xml`, `cs_dotnet_aspire.xml`, `rb_antiwork_flexile.xml`

- NOTE: **`<language>_<project>_clone_density.csv`**: Contains the **clone density metric** for each version of the project. This metric quantifies the proportion of cloned code in each commit/version, providing insights into code duplication patterns over time.
  - Examples: `py_mlflow_mlflow_clone_density.csv`, `cs_microsoft_testfx_clone_density.csv`


### ğŸ“Š Metrics Results Directory

The **`metrics_results/`** directory contains advanced analyses and metrics generated by scripts 6-10. These scripts analyze the genealogies from `genealogy_results/` and produce:

- **Script 6** - `projects_survival_overview.csv`: Lineage survival analysis (alive vs. dead clones by creator)
- **Script 7** - Pattern analysis CSVs:
  - `human_clones_change_patterns.csv`: Change patterns on human-created clones
  - `human_clones_evolution_patterns.csv`: Evolution patterns on human-created clones
  - `agent_clones_change_patterns.csv`: Change patterns on agent-created clones
  - `agent_clones_evolution_patterns.csv`: Evolution patterns on agent-created clones
- **Script 8** - Deep pattern analysis:
  - `evolution_patterns_summary.csv`: Detailed evolution patterns by lineage creator and modifier
  - `change_patterns_summary.csv`: Detailed change patterns by lineage creator and modifier
- **Script 9** - Volatility analysis:
  - `<project_name>_volatility.png`: Volatility graphs for each project
- **Script 10** - Statistical analysis:
  - `statistical_test_output.txt`: Chi-square test results
  - `statistical_test_results.csv`: Statistical test data
  - `correlation_summary.txt`: Correlation summary report

---

## ğŸ“– License

This project is part of the MSR 2026 Mini-Challenge.
